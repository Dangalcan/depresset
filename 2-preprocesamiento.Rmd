---
title: "Estudio sobre la depresión estudiantil. Grupo 5. Preprocesamiento"
author: "Miguel Encina Martinez, Daniel Galván Cancio, Jaime Linares Barrera, Daniel Vela Camacho"
output:
  html_document:
    toc: true
    toc_float: true
    # number_sections: true
---

# Preprocesamiento

En este apartado vamos a realizar las transformaciones necesarias para dejar nuestro dataset listo para análisis más avanzados y modelado predictivo. Entre las tareas principales se incluyen:

- Filtrado de participantes que no sean estudiantes.

- Eliminación de columnas irrelevantes.

- Recodificación de variables categóricas binarias (“Yes”/“No”) a numéricas.

- Discretización y codificación de variables ordinales, como la duración del sueño.

- Posible agrupación o recodificación de variables con niveles poco representativos.

- Identificación y tratamiento de valores extremos en variables numéricas.


Antes de comenzar, vamos a importar las librerías que nos van a hacer falta en este notebook.

```{r}
  #install.packages("dplyr")
  library(dplyr)
```

## 1. Lectura del dataset

Leemos el archivo CSV `student_depression_dataset` que se encuentra en la carpeta `data`.

```{r}
  data <- read.csv("./data/student_depression_dataset.csv", sep=",")
  head(data)
```

# 1. Filtrado y eliminación de columnas innecesarias

Como la mayoría de participantes son estudiantes, filtramos aquellas filas que no lo sean y eliminamos columnas irrelevantes para nuestro análisis:

```{r}
  df_procesado <- data %>%
  filter(Profession == "Student") %>%
  select(-c(Profession, id, Work.Pressure, Job.Satisfaction))
```

Como hay columnas que tienen variables con valores: "Yes" y "No", vamos a cambiar las columnas para que sus valores sean 1 en caso de "Yes" y 0 en caso de "No"

```{r}

  df_procesado <- df_procesado %>%
  mutate(
  Have.you.ever.had.suicidal.thoughts.. = ifelse(Have.you.ever.had.suicidal.thoughts.. == "Yes", 1, 0),
  Family.History.of.Mental.Illness = ifelse(Family.History.of.Mental.Illness == "Yes", 1, 0)
  )

```

```{r}
  head(df_procesado)
```


# 3. Codificación de variables ordinales

La duración del sueño es una variable ordinal con categorías claras. Como las horas de sueño tienen valores categóricos que tienen cierto orden, vamos a discretizarlas. Hay un problema con esta vairable ya que al acotarlo en el intervalo, uno de los valores posible (Others) no tenía doble comillas. Además, vamos a eliminar aquellas filas cuyo valor en esa columna sea "Others"

```{r}
# Definimos los niveles de sueño de manera ordenada, excluyendo "Others"

  sleep_order <- c(
  "'Less than 5 hours'",
  "'5-6 hours'",
  "'7-8 hours'",
  "'More than 8 hours'"
  )

df_procesado <- data %>%

# Eliminamos filas donde Sleep.Duration sea "Others"

  filter(Sleep.Duration != "Others") %>%
  mutate(
  # Paso A: Creamos el Factor Ordenado
  Duracion_Sueno_Factor = factor(Sleep.Duration,
  levels = sleep_order,
  ordered = TRUE),
  # Paso B: Creamos la versión Numérica (del Factor)
  Duracion_Sueno_Num = as.numeric(Duracion_Sueno_Factor)
  )

# Comprobamos la codificación

  df_procesado %>%
  group_by(
  Original = Sleep.Duration,
  Factor_Ordenado = Duracion_Sueno_Factor,
  Numero_Codificado = Duracion_Sueno_Num
  ) %>%
  count()

```

```{r}


```

```{r}


```

```{r}


```

```{r}


```

