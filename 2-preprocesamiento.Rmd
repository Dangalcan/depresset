---
title: "Estudio sobre la depresión estudiantil. Grupo 5. Preprocesamiento"
author: "Miguel Encina Martinez, Daniel Galván Cancio, Jaime Linares Barrera, Daniel Vela Camacho"
output:
  html_document:
    toc: true
    toc_float: true
    # number_sections: true
---

# Preprocesamiento

En este apartado vamos a realizar las transformaciones necesarias para dejar nuestro dataset listo para análisis más avanzados y modelado predictivo. Entre las tareas principales se incluyen:

-   Filtrado de participantes que no sean estudiantes.

-   Eliminación de columnas irrelevantes.

-   Recodificación de variables categóricas binarias (“Yes”/“No”) a numéricas.

-   Discretización y codificación de variables ordinales, como la duración del sueño.

-   Posible agrupación o recodificación de variables con niveles poco representativos.

-   Identificación y tratamiento de valores extremos en variables numéricas.

Antes de comenzar, vamos a importar las librerías que nos van a hacer falta en este notebook.

```{r}
#install.packages("dplyr")
library(dplyr)
```

## 1. Lectura del dataset

Leemos el archivo CSV `student_depression_dataset` que se encuentra en la carpeta `data`.

```{r}
data <- read.csv("./data/student_depression_dataset.csv", sep=",")
head(data)
```

## 2. Filtrado por estudiantes y eliminación de columnas innecesarias

Como hemos comentado en la parte de visualización del dataset, la mayoría de participantes son estudiantes, por lo que vamos a hacer un filtro para quedarnos únicamente con los estudiantes y vamos a eliminar aquellas columnas que no van a aportarnos ninguna información como son:

-   `id`: identificador sin utilidad analítica.
-   `Work.Pressure`: constante en estudiantes (valor 0 en todos los casos).
-   `Job.Satisfaction`: constante en estudiantes (valor 0 en todos los casos).
-   `Profession`: vamos a trabajar solo con estudiantes

```{r}
df_students <- data %>%
  filter(Profession == "Student") %>%
  select(-c(Profession, id, Work.Pressure, Job.Satisfaction))

head(df_students)
```

## 3. Renombrar variables

Vamos a renombrar el nombre de cierta variables para que sea más comodo trabajar con ellas.

```{r}
df_students <- df_students %>%
  rename(Had.suicidal.thoughts=Have.you.ever.had.suicidal.thoughts.., 
         Family.History.Mental.Illness=Family.History.of.Mental.Illness)
```

## 4. Codificación de variables booleanas

Tenemos ciertas variables booleanas con valores: "Yes" y "No". Vamos a cambiar las columnas para que sus valores sean 1 en caso de "Yes" y 0 en caso de "No".

```{r}

df_students <- df_students %>%
  mutate(
    Had.suicidal.thoughts = ifelse(Had.suicidal.thoughts == "Yes", 1, 0),
    Family.History.Mental.Illness = ifelse(Family.History.Mental.Illness == "Yes", 1, 0)
  )

head(df_students)
```

## 5. Codificación de variables ordinales

La duración del sueño es una variable ordinal con categorías claras. Como las horas de sueño tienen valores categóricos que tienen cierto orden, vamos a discretizarlas. Hay un problema con esta vairable ya que al acotarlo en el intervalo, uno de los valores posible (Others) no tenía doble comillas. Además, vamos a eliminar aquellas filas cuyo valor en esa columna sea "Others"

```{r}
sleep_order <- c(
  "'Less than 5 hours'",
  "'5-6 hours'",
  "'7-8 hours'",
  "'More than 8 hours'"
)

# df_students <- df_students %>%
#   # eliminamos filas donde Sleep.Duration sea "Others"
#   filter(Sleep.Duration != "Others") %>%
#   mutate(
#     # creamos el Factor Ordenado
#     Duracion_Sueno_Factor = factor(Sleep.Duration,
#     levels = sleep_order,
#     ordered = TRUE),
#     # creamos la versión Numérica (del Factor)
#     Duracion_Sueno_Num = as.numeric(Duracion_Sueno_Factor)
#   )
# 
# df_students %>%
#   group_by(
#     original = Sleep.Duration,
#     factor_ordenado = Duracion_Sueno_Factor,
#     numero_codificado = Duracion_Sueno_Num
#   ) %>%
#   count()
```

```{r}
str(df_students)
```

```{r}


```

```{r}


```

```{r}


```
